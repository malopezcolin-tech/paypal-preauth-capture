<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>ðŸ’³ Pago con PreautorizaciÃ³n</title>
  <script src="https://www.paypal.com/sdk/js?client-id=AQipbXia4TEIQOiol5Q7ZMkpJOBM5grLZDuQOOYd6HvUG16a7pK0a_NndaRsorh9oD98QIhbYtEC1Tww&components=buttons,hosted-fields&enable-funding=card"></script>
</head>
<body>
  <h2>ðŸ’³ Pago con PreautorizaciÃ³n</h2>
  <label>Monto a pagar (USD): </label>
  <input type="number" id="amount" value="10.00" step="0.01">
  
  <div id="paypal-button-container"></div>

  <script>
    paypal.Buttons({
      createOrder: async () => {
        const amount = document.getElementById("amount").value;
        const res = await fetch("/create-order", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ amount })
        });
        const data = await res.json();
        return data.id;
      },
      onApprove: async (data) => {
        const res = await fetch("/authorize-order", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ orderID: data.orderID })
        });
        const authData = await res.json();
        alert("âœ… Autorizado: " + JSON.stringify(authData, null, 2));
      }
    }).render("#paypal-button-container");
  </script>
</body>
</html>
